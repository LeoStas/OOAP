% После процента идут комментарии

% Класс документа
\documentclass[11pt,a4paper,twoside,listtotoc,bibtotoc]{report}
% Размеры полей
\usepackage[top=1in, bottom=1.3in, left=1in, right=1in]{geometry}

% Кодировка файла
\usepackage[utf8]{inputenc}
% Переносы для русского языка
\usepackage[russian]{babel}


\usepackage{graphicx}
\usepackage{tikz}
\usepackage{epstopdf}
\usepackage[unicode]{hyperref}
\usepackage{float}

\usepackage{longtable}
\usepackage{enumerate}
\usepackage{enumitem}


\hypersetup{
    colorlinks,
    breaklinks,
    linkcolor=[rgb]{0.07, 0.03, 0.56},
    citecolor=[rgb]{0.1, 0.45, 0.27},
    %colorlinks=true,% hyperlinks will be coloured
    urlcolor=[rgb]{0.07, 0.03, 0.56},
    %linkbordercolor=[rgb]{0.07, 0.03, 0.56}
}


\usepackage{fancyhdr}
\fancyhead{}
\fancyhead[LE]{\thepage}
\fancyhead[CE]{{\normalfont \leftmark}}
\fancyhead[CO]{{\normalfont \rightmark}}
\fancyhead[RO]{\thepage}
\fancyfoot{}

\makeatletter
\let\ps@plain\ps@empty
\makeatother

% Отступ абзаца после заголовка
%\usepackage{indentfirst}

%\usepackage{titlesec}
\usepackage[toctitles]{titlesec}
\renewcommand{\thesection}{\arabic{section}}
% Добавить символ параграфа в нумерации section
\let\oldthesection\thesection \renewcommand\thesection{\S \oldthesection}

\usepackage{amsmath}
% Нумерация в пределах параграфа
\numberwithin{equation}{section}
% Изменить формат нумерации формул с (1.2) на (2)
\renewcommand{\theequation}{\arabic{equation}}

\usepackage{cmap}
% Разные математические шрифты
% Например, для обозначения множества вещественных чисел
\usepackage{amsfonts}
% Математические символы
\usepackage{amssymb}
% Для изменения символов нумерации
\usepackage{enumerate}
% Для нумерованных списков
\usepackage{enumitem}
% Декартов крест
\DeclareFontFamily{U}{mathx}{\hyphenchar\font45}
\DeclareFontShape{U}{mathx}{m}{n}{
      <5> <6> <7> <8> <9> <10>
      <10.95> <12> <14.4> <17.28> <20.74> <24.88>
      mathx10
      }{}
\DeclareSymbolFont{mathx}{U}{mathx}{m}{n}
\DeclareMathSymbol{\bigtimes}{1}{mathx}{"91}

\usepackage{array}

% Теоремы
\usepackage{amsthm}
    \newtheorem*{statement}{Утверждение}
    \newtheorem*{problem}{Задача}
    \newtheorem*{definition}{Определение}

    \theoremstyle{definition}
    \newtheorem{example}{Пример}[section]
    \renewcommand{\theexample}{\arabic{example}}
    \newtheorem*{example*}{Пример}

    \theoremstyle{plain}
    \newtheorem{theorem}{Теорема}[section]
    \renewcommand{\thetheorem}{\arabic{theorem}}
    \newtheorem*{theorem*}{Теорема}

    \newtheorem{new_note}{Замечание}[section]

    \newtheorem{note}{Замечание}[section]
    \renewcommand{\thenote}{\arabic{note}}



    \newtheorem{lemma}{Лемма}[section]
    \renewcommand{\thelemma}{\arabic{lemma}}
    \newtheorem*{lemma*}{Лемма}

    \newtheorem*{note*}{Замечание}

    \newtheorem{formulation}{Постановка задачи}

    \newtheorem*{formulation*}{Постановка задачи}

    \newtheorem{cons}{Следствие}[section]
    \renewcommand{\thecons}{\arabic{cons}}
    \newtheorem*{cons*}{Следствие}

    \makeatletter \renewenvironment{proof}[1][\proofname] {\par\pushQED{\qed}\normalfont\topsep6\p@\@plus6\p@\relax\trivlist\item
    [\hskip\labelsep\bfseries#1\@addpunct{.}]\ignorespaces}
    {\popQED\endtrivlist\@endpefalse} \makeatother

    \makeatletter \newenvironment{solution}[1][Решение] {\par\pushQED{\qed}\normalfont\topsep6\p@\@plus6\p@\relax\trivlist\item
    [\hskip\labelsep\bfseries#1\@addpunct{.}]\ignorespaces}
    {\popQED\endtrivlist\@endpefalse} \makeatother

% Новая строка после названия пункта
\makeatletter
\renewcommand\paragraph{%
   \@startsection{paragraph}{4}{0mm}%
      {-\baselineskip}%
      {.5\baselineskip}%
      {\normalfont\large\bfseries}}
\makeatother

\makeatletter
\DeclareRobustCommand*{\bfseries}{%
  \not@math@alphabet\bfseries\mathbf
  \fontseries\bfdefault\selectfont
  \boldmath
}
\makeatother

% Для систем уравнений
\usepackage{cases}

\makeatletter
\newenvironment{sqcases}{%
  \matrix@check\sqcases\env@sqcases
}{%
  \endarray\right.%
}
\def\env@sqcases{%
  \let\@ifnextchar\new@ifnextchar
  \left\lbrack
  \def\arraystretch{1.2}%
  \array{@{}l@{\quad}l@{}}%
}
\makeatother

\usepackage{mathtools}
% Норма вектора
\DeclarePairedDelimiter\norm{\lVert}{\rVert}
% Целая часть сверху
\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
% Оператор sgn
\DeclareMathOperator{\sgn}{sgn}
% Оператор diag
\DeclareMathOperator{\diag}{diag}

\makeatletter
\DeclareRobustCommand*{\bfseries}{%
  \not@math@alphabet\bfseries\mathbf
  \fontseries\bfdefault\selectfont
  \boldmath
}
\makeatother

\begin{document}
\pagestyle{empty}
%
\begin{center}
    \vspace*{-0.7in}
    \includegraphics[width=0.5\textwidth]{msu.eps}\\
    {\scshape Московский государственный университет имени М.\,В. Ломоносова}\\
    Факультет вычислительной математики и кибернетики\\
    Кафедра АСВК\\
    \vfill
    %{\LARGE }\\
    %\vspace{0.55cm}
    {\Huge\bfseries Отчет по второму заданию курса ООАП.}\\
    \vspace{0.8cm}
    {\LARGE Вариант №$4$}\\
    {\LARGE <<Онлайновая билетная касса>>}

\end{center}
%
\vspace{6cm}
\begin{flushright}
    \large
    \textit{Выполнил:}\\
    Селецкий С.\,В., $421$ группа\\
\end{flushright}
%
\vfill
%
\begin{center}
    Москва, 2013
\end{center}
%
%
\newpage
%
\addtocontents{toc}{\protect\thispagestyle{empty}}
\tableofcontents
\newpage
\phantomsection
\pagestyle{plain}
%
\section{Постановка задачи}
%
Онлайновая касса <<чух-чух.рф>> представляет собой web-сайт службы
бронирования и доставки билетов на поезда дальнего следования.
Перед тем, как впервые воспользоваться услугами кассы, клиент должен
зарегистрироваться. В ходе регистрации он указывает данные о себе
(фио, телефон, адрес электронной почты, паспортные данные) и получает
логин и пароль (логины и пароли разных клиентов не должны совпадать).

Войдя в систему, клиент может ознакомиться с расписанием движения
поездов между нужными ему населёнными пунктами, выбрать станцию и
дату отправления, а также номер поезда. Получив от системы сведения
о билетах, имеющихся в наличии, пользователь может забронировать
нужное ему количество билетов. Билеты бывают разных типов: плацкартные,
купейные ($1$, $2$ и $3$ класса), сидячие, в мягкий вагон, в вагон люкс
и т. п. Места могут быть верхними, нижними, боковыми, в зависимости от
расположения в вагоне. Цена билета зависит от маршрута следования,
типа поезда (фирменный/скорый/пассажирский), типа вагона, в котором расположено
пассажирское место, и расположения места в вагоне. Билеты могут быть
выкуплены в течение трех суток с момента бронирования, но не позднее
двух суток до отправления поезда. Клиент может самостоятельно выкупить
забронированные билеты, приехав в офис, или заказать доставку билетов курьером,
сделав пометку в заявке и указав адрес доставки. Стоимость доставки зависит от
дальности: центр/спальный район/дальний пригород. Клиент может получить
информацию обо всех своих заявках с web-страницы онлайновой кассы.

Заявки клиентов хранятся в системе. В каждой указаны: сведения о клиенте,
сведения об одном или более билетах (к одной заявке может относиться
несколько билетов на одно и то же имя), общая стоимость билетов в
заявке, время создания заявки, время оплаты, вид доставки
(самовывоз/курьер), адрес доставки, стоимость доставки, статус заявки
(новая/рабочая/оплаченная/аннулированная). По истечении $12$ месяцев с
момента создания заявки данные автоматически удаляются из системы.

В обязанности работников онлайновой кассы входит внесение в систему сведений
о расписании поездов, стоимости проезда и об имеющихся в наличии местах, на
которые могут быть куплены билеты. Некоторые поезда ходят ежедневно. Другие
назначаются только в определённый день (определённые дни) недели. Также есть
отдельные поезда, назначаемые на конкретные дни года. Данные о билете содержат
уникальный номер билета, даты и станции отправления и прибытия, тип билета,
номер места, цену билета, статус билета
(место свободно/забронировано/продано/передано для реализации в кассы на вокзалах).
По истечении 12 месяцев
с даты, указанной в билете, данные автоматически удаляются из системы.

Работник кассы, получив новую заявку клиента, связывается с ним для подтверждения
и уточнения мест. Согласовав с клиентом места, работник делает пометку о бронировании
билетов в системе (тем самым уменьшается количество билетов, имеющихся в наличии)
и меняет статус заявки на <<рабочая>>. После оплаты и/или доставки <<рабочей>> заявки
билеты из заявки помечаются как проданные, а заявка --- как оплаченная. За $2$ суток
до отправления поезда все непроданные билеты передаются для реализации в обычные
кассы, в системе они автоматически помечаются как <<передан для реализации>>,
заявки на них аннулируются, клиенты, не успевшие оплатить заказанные билеты,
информируются о снятии брони. Через $4$ суток после создания все неоплаченные <<рабочие>>
заявки автоматически аннулируются, бронирование с билетов снимается, клиентам
посылается соответствующее сообщение. Также должна быть возможность аннулирования
заявок вручную работниками онлайновой кассы. При аннулировании заявки вручную работник
должен уведомить клиента, изменить статус заявки, снять бронирование билетов
(количество билетов в наличии возрастает).

%
\newpage
%
%
\section{Глоссарий}
%
%
\begin{center}
%
\begin{longtable}[h!]{ | p{0.3\linewidth} || p{0.7\linewidth} |}
%
    \hline
    
    {\bfseries Система} $(System)$ & Система службы бронирования и доставки билетов, предоставляющая услуги клиентам. \\
    \hline
    
    {\bfseries Клиент} $(Client)$ & Лицо, пользующееся услугами системы. \\
    \hline
    
    {\bfseries База данных клиентов} $(ClientsDB)$
        &
        База данных, содержащая информацию о клиентах, вносимую ими при регистрации (ФИО, 
        номер телефона, адрес электронной почты, паспортные данные). А также автоматически 
        генерируемую информацию (уникальный логин, пароль).\\
    \hline
    
    {\bfseries Расписание} $(Schedule)$ & Содержит всю информацию о движении поездов между станциями
        (номера поездов, которые останавливаются на этих станциях; стоимость проезда на каждом поезде;
        дата и время прибытия каждого поезда на станции и отправки с них).
    \\
    \hline

    {\bfseries Место} $(Seat)$ & Место в поезде (тип места (верхнее, нижнее или боковое); номер места в вагоне;
        номер вагона в поезде).
     \\
    \hline

    {\bfseries Поезд} $(Train)$ & Хранит информацию о поезде (номер поезда; тип поезда (фирменный~/ скорый~/ пассажирский);
            для каждой станции хранится список билетов, действующих на этой станции; список мест в поезде;
            список посещаемых станций; времена и даты прибытия и отправки от каждой станции).
    \\
    \hline

    {\bfseries Список поездов} $(TrainsList)$ & Список всех экземпляров типа <<Поезд>>. \\
    \hline

    {\bfseries Билет} $(Ticket)$ & Содержит информацию о билете (уникальный номер билета; дата и время отправления и прибытия;
            станции отправления и прибытия; уникальный номер места (т.е. тройка: номер поезда, номер вагона, номер места в вагоне);
            тип билета (плацкартный, купейный ($1$, $2$ и $3$ класса), сидячий, в мягкий вагон, в вагон люкс и т. п.); 
            цена билета (зависит от стоимости маршрута следования, типа поезда, типа билета и типа места); 
            статус билета (место свободно~/ забронировано~/ продано~/ передано для реализации в кассы на вокзалах);
            данные клиента, купившего или забронировавшего билет (если место продано или забронировано).
    \\
    \hline
    
    {\bfseries База данных всех билетов} $(TicketsDB)$ & Содержит информацию о всех билетах в системе. \\
    \hline

    {\bfseries База данных заявок} $(RequestsDB)$ & Все заявки, хранимые в системе. \\
    \hline

    {\bfseries Заявка} $(Request)$ & Хранит информацию о заявке клиента (сведения о клиенте; сведения об одном и более билетах 
        (к одной заявке может относиться несколько билетов на одно и то же имя); общая стоимость билетов в заявке; 
        время создания заявки; время оплаты; вид доставки (самовывоз/курьер); адрес доставки; стоимость доставки; статус заявки 
        (новая~/ рабочая~/ оплаченная~/ аннулированная).
    \\
    \hline

    {\bfseries Работники онлайновой кассы} $(Staff)$ & В обязанности работников онлайновой кассы входит внесение в систему сведений
        о расписании поездов, стоимости проезда и об имеющихся в наличии местах, на которые могут быть куплены билеты. \\
    \hline

    {\bfseries Служба доставки} $(DeliveryOffice)$ & В их обязанности входит доставка билетов до клиентов. \\
    \hline

\end{longtable}
%
\end{center}
%
%
\newpage
%
%
\section{Варианты использования}
%
\subsection{Войти в систему}
%
\paragraph{Краткое описание}
%
Данный вариант использования описывает вход пользователя в систему бронирования и покупки билетов.
%
\paragraph{Основной поток событий}
%
\begin{enumerate}
    \item Система запрашивает имя пользователя и пароль.
    \item Пользователь вводит имя и пароль.
    \item Система подтверждает правильность имени и пароля, определяет тип пользователя (клиент или кассир) и выводит главное меню, дающее доступ к функциям    системы в соответствии с типом пользователя.
\end{enumerate}
%
\paragraph{Альтернативные потоки}
%
\begin{description}
    \item[3A] Неправильное имя/пароль
            %
            \begin{enumerate}
                \item Система обнаруживает, что комбинация имени и пароля не верна.
                \item Система сообщает об ошибке и предлагает пользователю либо заново ввести имя и пароль, либо отказаться от входа в систему.
                \item Пользователь сообщает системе свой выбор.
                \item В соответствии с выбором пользователя либо выполнение переходит на начало основного потока, либо вариант использования завершается.
            \end{enumerate}
            %
\end{description}
%
\paragraph{Предусловия}

Отсутствуют.

\paragraph{Постусловия}

Если вариант использования выполнен успешно, система предоставляет доступ к главному меню пользователю, сообщившему верную комбинацию имени и пароля. В противном случае система гарантирует, что пользователю, сообщившему неверную комбинацию имени и пароля, доступ к меню не будет предоставлен. 

%
\newpage
%


%
\subsection{Зарегистрироваться в системе}
%
\paragraph{Краткое описание}
%
Данный вариант использования описывает регистрацию клиента в системе бронирования и покупки билетов.
%
\paragraph{Основной поток событий}
%
\begin{enumerate}
    \item Система запрашивает у клиента его ФИО, данные паспорта, номер телефона, адрес электронной почты.
    \item Клиент вводит запрошенные данные.
    \item Система регистрирует данного клиента в своей базе данных клиентов.
    \item Система генерирует для данного пользователя уникальную пару логин-пароль.
\end{enumerate}
%
\paragraph{Альтернативные потоки}
%
%\renewcommand{\labelenumi}{{\it \arabic{enumi}.\Alph{enumii}} }
\begin{description}
    \item[3A] Пользователь уже зарегистрирован
        %
        \begin{enumerate}
            \item Система обнаруживает, что данный клиент уже зарегестрирован.
            \item Cистема сообщает об ошибке и предлагает клиенту либо повторно ввести свои данные, 
                либо отказаться от регистрации.
            \item В соответствии с выбором клиента либо выполнение переходит на начало основного потока, либо вариант использования завершается.
        \end{enumerate}
        %
\end{description}
%
\paragraph{Предусловия}
%
Отсутствуют.
%
\paragraph{Постусловия}
%
Если вариант использования выполнен успешно, система регистрирует нового клиента, а его данные заносит в свою базу данных клиентов.
В противном случае, система не регистрирует нового клиента.

%
\newpage
%


%
\subsection{Выбрать билет}
%
%
\paragraph{Краткое описание}
%
Данный вариант использования позволяет пользователю узнать, есть ли билет на заданное направление, сколько он стоит, и выдать его.
%
\paragraph{Основной поток событий}
%
%
\begin{enumerate}
   \item Клиент сообщает о своём желании приобрести билет.
   \item Система устанавливает сеанс связи с базой данных билетов.
   \item Система запрашивает информацию о станциях отправления и прибытия.
   \item Клиент сообщает названия станций отправления и прибытия.
   \item Система запрашивает желаемое время отправления.
   \item Клиент сообщает системе желаемое время отправления.
   \item Система выдаёт клиенту список поездов, идущих между этими станциями в это время.
   \item Клиент сообщает номер поезда.
   \item Система выдаёт список свободных мест в поезде заданного номера.
   \item Клиент выбирает свободное место и сообщает системе свой выбор.
   \item Система производит подсчёт стоимости проезда на данном месте.
   \item Система запрашивает разрешение на генерацию билета.
   \item Клиент разрешает создание билета.
   \item Система генерирует билет с заданными параметрами и помещает его в базу билетов.
   \item Система завершает сеанс связи с базой данных билетов.
\end{enumerate}
%
%
\paragraph{Подчинённые потоки событий}
%
\begin{description}
    \item[14A] Генерация билета и занесение в базу.
        %
        \begin{enumerate}
            \item Система создаёт новый билет с уникальным номером.
            \item Система прописывает в билете информацию о станциях отправления и прибытия, дату и время отправления/прибытия, 
                тип билета, цену билета, информацию о клиенте, время создания.
            \item Система устанавливает статус билета в <<свободно>>.
            \item Система заносит сведения о билете в базу данных билетов.
            \item Система помечает место из билета в <<занято>>.
            \item Управление переходит на шаг 15 основного потока событий.
        \end{enumerate}
        %
\end{description}
%
\paragraph{Альтернативные потоки}
%
%
\begin{description}
    \item[14A1A] В базе билетов есть билет на это время.
        %
        \begin{enumerate}
            \item Система возвращает пользователю существующий билет.
            \item Cистема помечает место из билета в <<занято>>.
            \item Управление переходит на шаг 15 основного потока событий.
        \end{enumerate}
        %
    \item[2A] Связь не установлена.
        %
        \begin{enumerate}
            \item Система обнаруживает, что связь с базой данных билетов не может быть установлена.
            \item Система сообщает об ошибке.
            \item Система завершает выполнения варианта использования.
        \end{enumerate}
        %
    \item[7A] Поездов в данное время на данном направлении нет.
        %
        \begin{enumerate}
            \item Система обнаруживает, что в заданное время между этими двумя станциями поезда не ходят.
            \item Система сообщает клиенту об отсутствии поездов в данное время и предлагает клиенту либо ввести другое время отправления, 
                либо отказаться от бронирования.
            \item В зависимости от выбора клиента выполнение либо переходит на шаг 5 основного потока событий, либо завершается.
        \end{enumerate}
        %
    \item[9A] Свободных мест в поезде нет.
        %
        \begin{enumerate}
            \item Система обнаруживает, что свободных мест в поезде нет.
            \item Cистема сообщает клиенту об отсутствии свободных мест в поезде и предлагает клиенту либо ввести другой номер поезда, 
                либо отказаться от бронирования.
            \item В зависимости от выбора клиента выполнение либо переходит на шаг 8 основного потока событий, либо завершается.
        \end{enumerate}
        %
    \item[13A] Клиент запрещает генерацию билета.
        %
        \begin{enumerate}
            \item Система предлагает клиенту либо выбрать другое место, либо отказаться от бронирования.
            \item В зависимости от выбора клиента выполнение либо переходит на шаг 10 основного потока событий, либо завершается.
        \end{enumerate}
        %

\end{description}
%
%
\paragraph{Предусловия}
%
Перед началом выполнения данного варианта использования клиент должен войти в систему.
%
\paragraph{Постусловия}
%
В случае удачного выполнения варианта использования создаётся билет с уникальным номером для данного клиента и помещается в базу данных билетов.
В противном случае данные в базе не меняются, билет не создаётся, а клиент оповещается о невозможности создания билета.

%
\newpage
%


%
\subsection{CR заявки}
%
%
\paragraph{Краткое описание}
%
В зависимости от потребностей клиента вариант использования может создать или запросить заявку.
%
\paragraph{Основной поток событий}
%
%
\begin{enumerate}
    \item Система устанавливает связь с базой данных билетов.
    \item Система устанавливает связь с базой данных заявок.
    \item Система запрашивает у клиента выбор действия (создание заявки, запрос заявки).
    \item Система выполняет действия в соответствии с выбором клиента.
    \item Система завершает сеанс связи с базой данных билетов.
    \item Система завершает сеанс связи с базой данных заявок.
\end{enumerate}
%
%
\paragraph{Подчинённые потоки событий}
%
%
\begin{description}
    \item[4A] Создание заявки.
        %
        \begin{enumerate}
            \item Система создаёт заявку с уникальным номером.
            \item Cистема извлекает из базы билетов билеты, связанные с этим клиентом, и заносит их номера в заявку.
            \item Система прописывает в заявке информацию о клиенте, общую стоимость всех билетов, время и дату создания заявки.
            \item Система запрашивает у клиента информацию о доставке.
            \item Клиент отказывается от доставки.
            \item Вид доставки устанавливается в «самовывоз».
            \item Система устанавливает статус заявки в «новая».
            \item Система заносит заявку в базу заявок.
            \item Управление передаётся на пункт 5 основного потока событий.
        \end{enumerate}
        %
    \item[4B] Запрос заявки.
        %
        \begin{enumerate}
            \item Если в базе заявок есть заявка, ассоциированная с клиентом, данные о ней выводятся пользователю.
            \item Управление передаётся на пункт 5 основного потока событий.
        \end{enumerate}
        %
    \item[4C] Отказ от выбора.
        %
        \begin{enumerate}
            \item Клиент отказывается от выбора.
            \item Управление передаётся на пункт 5 основного потока событий.
        \end{enumerate}
        %
\end{description}
%
%
\paragraph{Альтернативные потоки}
%
%
\begin{description}
    \item[4A5A] Клиент соглашается на доставку.
        %
        \begin{enumerate}
            \item Система запрашивает адрес доставки у клиента.
            \item Клиент вводит адрес.
            \item Система заносит адрес доставки в билет.
            \item Вид доставки устанавливается в «курьер».
            \item В зависимости от дальности доставки система устанавливает цену доставки.
            \item Выполнение переходит на пункт 4А7.
        \end{enumerate}
        %
    \item[4A5A2A] Клиент не вводит адрес.
        %
        \begin{enumerate}
            \item Система отменяет создание заявки. Уже созданная заявка удаляется.
            \item Система уведомляет клиента об ошибке создания заявки. 
            \item Управление передаётся на пункт 5 основного потока событий.
        \end{enumerate}
        %
    \item[1A] Связь с базой билетов не установлена.
        %
        \begin{enumerate}
            \item Система обнаруживает, что связь с базой данных билетов не может быть установлена.
            \item Система сообщает об ошибке.
            \item Система завершает выполнения варианта использования.
        \end{enumerate}
        %
    \item[2A] Связь с базой заявок не установлена.
        %
        \begin{enumerate}
            \item Система обнаруживает, что связь с базой данных заявок не может быть установлена.
            \item Система сообщает об ошибке.
            \item Система завершает выполнения варианта использования.
        \end{enumerate}
        %
\end{description}
%
%
\paragraph{Предусловия}
%
Клиент должен выполнить вход в систему и выбрать хотя бы один билет.
%
\paragraph{Постусловия}
%
В случае успешного выполнения варианта использования система либо создаст заявку для клиента, либо выведет ему информацию о его заявках.
В противном случае ничего сделано не будет.


%
\newpage
%

%
\subsection{Аннулирование заявки}
%
%
\paragraph{Краткое описание}
%
Вариант использования позволяет аннулировать находящуюся в базе заявок заявку.
%
\paragraph{Основной поток событий}
%
%
\begin{enumerate}
    \item Система устанавливает связь с базой данных билетов.
    \item Система устанавливает связь с базой данных заявок.
    \item Система запрашивает у пользователя уникальный номер заявки.
    \item Если заявка найдена в базе заявок, выполняется её аннулирование.
    \item Система завершает сеанс связи с базой данных билетов.
    \item Система завершает сеанс связи с базой данных заявок.
\end{enumerate}
%
%
\paragraph{Подчинённые потоки событий}
%
%
\begin{description}
    \item[4A] Аннулирование заявки.
        %
        \begin{enumerate}
            \item Для каждого билета из списка билетов выполняется:
                %
                \begin{enumerate}
                    \item Система удаляет билет из базы билетов.
                    \item Места, указанные в билете, становятся свободными.
                \end{enumerate}
                %
            \item Система изменяет статус заявки на «аннулированная».
            \item Система уведомляет клиента из заявки об её аннулировании.
            \item Управление передаётся на пункт 5 основного потока событий.
        \end{enumerate}
        %
\end{description}
%
%
\paragraph{Альтернативные потоки}
%
\begin{description}
    \item[3A] Пользователь отменил ввод.
        %
        \begin{enumerate}
            \item Система оповещает пользователя об удачной отмене аннулирования.
            \item Управление передаётся на пункт 5 основного потока событий.
        \end{enumerate}
        %
    \item[3B] Ошибка доступа.
        %
        \begin{enumerate}
            \item Если пользователь является клиентом, а данные в заявке не совпадают с его данными, 
                система генерирует сообщение об ошибке прав доступа, а управление передаётся на пункт 
                5 основного потока событий.
        \end{enumerate}
        %
    \item[1A] Связь с базой билетов не установлена.
        %
        \begin{enumerate}
            \item Система обнаруживает, что связь с базой данных билетов не может быть установлена.
            \item Система сообщает об ошибке.
            \item Система завершает выполнения варианта использования.
        \end{enumerate}
        %
    \item[2A] Связь с базой заявок не установлена.
        %
        \begin{enumerate}
            \item Система обнаруживает, что связь с базой данных заявок не может быть установлена.
            \item Система сообщает об ошибке.
            \item Система завершает выполнения варианта использования.
        \end{enumerate}
        %
\end{description}
%
%
\paragraph{Предусловия}
%
Пользователь должен выполнить вход в систему.
%
\paragraph{Постусловия}
%
Если вариант использования выполнен успешно, заявка аннулируется. В противном случае заявка не изменяется.


%
\newpage
%

%
\subsection{Отправить заявку на выполнение}
%
%
\paragraph{Краткое описание}
%
Вариант использования позволяет выполнить действия, соответствующие статусу заявки.
%
\paragraph{Основной поток событий}
%
%
\begin{enumerate}
    \item Система устанавливает связь с базой данных билетов.
    \item Система устанавливает связь с базой данных заявок.
    \item Cистему устанавливает связь со службой доставки.
    \item Система запрашивает у кассира уникальный номер заявки.
    \item Если заявка найдена в базе заявок, выполняются над ней действия в зависимости от её статуса.
    \item Система завершает сеанс связи со службой доставки.
    \item Система завершает сеанс связи с базой данных билетов.
    \item Система завершает сеанс связи с базой данных заявок.
\end{enumerate}
%
%
\paragraph{Подчинённые потоки событий}
%
%
\begin{description}
    \item[5A] Заявка новая.
        %
        \begin{enumerate}
            \item Система меняет статус заявки на «рабочая».
            \item Для всех билетов из заявки выполняется:
                %
                \begin{enumerate}
                    \item Система меняет статус билета на «забронированно».
                \end{enumerate}
                %
            \item Если вид доставки в заявке «курьер», то заявка посылается в службу доставки.
            \item Управление передаётся на пункт 6 основного потока событий.
        \end{enumerate}
        %
    \item[5B] Заявка рабочая.
        %
        \begin{enumerate}
            \item Система меняет статус заявки на «оплаченная».
            \item Для всех билетов из заявки выполняется:
                %
                \begin{enumerate}
                    \item Система меняет статус билета на «продано».
                \end{enumerate}
                %
            \item Управление передаётся на пункт 6 основного потока событий.
        \end{enumerate}
        %
    \item[5С] Заявка оплаченная.
        %
        \begin{enumerate}
            \item Кассир уведомляется о статусе заявки.
            \item Управление передаётся на пункт 6 основного потока событий.
        \end{enumerate}
        %
    \item[5D] Заявка аннулированная.
        %
        \begin{enumerate}
            \item Кассир уведомляется о статусе заявки.
            \item Управление передаётся на пункт 6 основного потока событий.
        \end{enumerate}
        %
\end{description}
%
%
\paragraph{Альтернативные потоки}
%
%
\begin{description}
    \item[1A] Связь с базой билетов не установлена.
        %
        \begin{enumerate}
            \item Система обнаруживает, что связь с базой данных билетов не может быть установлена.
            \item Система сообщает об ошибке.
            \item Система завершает выполнения варианта использования.
        \end{enumerate}
        %
    \item[2A] Связь с базой заявок не установлена.
        %
        \begin{enumerate}
            \item Система обнаруживает, что связь с базой данных заявок не может быть установлена.
            \item Система сообщает об ошибке.
            \item Система завершает выполнения варианта использования.
        \end{enumerate}
        %
    \item[3A] Связь со службой доставки не установлена.
        %
        \begin{enumerate}
            \item Система обнаруживает, что связь со службой доставки не может быть установлена.
            \item Система сообщает об ошибке.
            \item Система завершает выполнения варианта использования.
        \end{enumerate}
        %
\end{description}
%
%
\paragraph{Предусловия}
%
Кассир должен выполнить вход в систему.
%
\paragraph{Постусловия}
%
В случае успешного выполнения варианта использования производятся действия в соответствии со статусом заявки.

%
\newpage
%

%
\subsection{Изменить данные о маршрутах}
%
%
\paragraph{Краткое описание}
%
Данный вариант использования позволяет изменять информацию в системе касательно наличия свободных мест, 
маршрутов поездов, стоимости проезда.
%
\paragraph{Основной поток событий}
%
%
\begin{enumerate}
    \item Система запрашивает у кассира тип вносимой информации (свободные места, маршруты поездов, стоимость проезда).
    \item В зависимости от типа ответа система выполняет соответствующие действия.
\end{enumerate}
%
%
\paragraph{Подчинённые потоки событий}
%
\begin{description}
    \item[2A] Свободное место.
        %
        \begin{enumerate}
            \item Пока действие не будет отменено кассиром, выполняется:
                %
                \begin{enumerate}
                    \item Система запрашивает информацию о поезде, времени отправления и станциях, на которых место будет свободно.
                    \item Кассир сообщает информацию.
                    \item Система помечает места статусом «свободно».
                \end{enumerate}
                %
            \item Вариант использования завершается.
        \end{enumerate}
        %
    \item[2B] Маршрут поезда.
        %
        \begin{enumerate}
            \item Пока действие не будет отменено кассиром, выполняется:
                %
                \begin{enumerate}
                    \item Система запрашивает номер поезда, а также время его отправления.
                    \item Кассир сообщает информацию.
                    \item Система список станций, посещаемых этим поездом.
                    \item Кассир добавляет/удаляет станции в этот список.
                    \item Система заносит сведения обо всех изменениях.
                \end{enumerate}
                %
            \item Вариант использования завершается.
        \end{enumerate}
        %
    \item[2C] Стоимость проезда.
        %
        \begin{enumerate}
            \item Пока действие не будет отменено кассиром, выполняется:
                %
                \begin{enumerate}
                    \item Система запрашивает номер поезда и новую стоимость.
                    \item Кассир сообщает информацию системе.
                    \item Система заносит сведения обо всех изменениях.
                \end{enumerate}
                %
            \item Вариант использования завершается.
        \end{enumerate}
        %
\end{description}
%
%
\paragraph{Альтернативные потоки}
%
%
\begin{description}
    \item[2A1(b)A] Кассир отменяет ввод данных
        %
        \begin{enumerate}
            \item Вариант использования завершается.
        \end{enumerate}
        %
    \item[2B1(b)A] Кассир отменяет ввод данных
        %
        \begin{enumerate}
            \item Вариант использования завершается.
        \end{enumerate}
        %
    \item[2C1(b)A] Кассир отменяет ввод данных
        %
        \begin{enumerate}
            \item Вариант использования завершается.
        \end{enumerate}
        %
\end{description}
%
%
\paragraph{Предусловия}
%
Кассир должен выполнить вход в систему.
%
\paragraph{Постусловия}
%
При правильном выполнении варианта использования новая информация будет занесена в систему.

%
\newpage
%

%
\subsection{Обновить базы}
%
%
\paragraph{Краткое описание}
%
По таймеру базы данных заявок и билетов устанавливаются в актуальное состояние.
%
\paragraph{Основной поток событий}
%
%
\begin{enumerate}
    \item Система устанавливает связь с базой данных билетов.
    \item Система устанавливает связь с базой данных заявок.
    \item Для всех билетов из базы данных билетов выполняется:
        %
        \begin{enumerate}
            \item Если текущее время таймера больше (времени создания билета + 3 дня)
                ИЛИ меньше (времени отхода поезда - 2 дня), то выполняется:
                %
                \begin{enumerate}
                    \item Система меняет статус билета на «передано для реализации в кассы».
                    \item Для всех заявок из базы заявок, содержащих ссылку на этот билет, выполняется:
                        %
                        \begin{enumerate}
                            \item Аннулировать эту заявку.
                        \end{enumerate}
                        %
                \end{enumerate}
                %
            \item Если текущее время таймера больше (время создания билета + 12 месяцев), 
                система удаляет билет из базы данных билетов.
        \end{enumerate}
        %
    \item Для всех заявок из базы данных заявок выполняется:
        %
        \begin{enumerate}
            \item Если текущее время таймера больше (времени создания заявки + 4 дня)
                И статус заявки — «рабочая», то выполняется:
                %
                \begin{enumerate}
                    \item Аннулировать заявку.
                \end{enumerate}
                %
            \item Если текущее время таймера больше (время создания билета + 12 месяцев), 
                система удаляет заявку из базы данных заявок.
        \end{enumerate}
        %
    \item Система завершает сеанс связи с базой данных билетов.
    \item Система завершает сеанс связи с базой данных заявок.
\end{enumerate}
%
%
\paragraph{Альтернативные потоки}
%
%
\begin{description}
    \item[1A] Связь с базой билетов не установлена.
        %
        \begin{enumerate}
            \item Система обнаруживает, что связь с базой данных билетов не может быть установлена.
            \item Система сообщает об ошибке.
            \item Система завершает выполнения варианта использования.
        \end{enumerate}
        %
    \item[2A] Связь с базой заявок не установлена.
        %
        \begin{enumerate}
            \item Система обнаруживает, что связь с базой данных заявок не может быть установлена.
            \item Система сообщает об ошибке.
            \item Система завершает выполнения варианта использования.
        \end{enumerate}
        %
\end{description}
%
%
\paragraph{Предусловия}
%
Отсутствуют.
%
\paragraph{Постусловия}
%
Если вариант использования отработал корректно, в системе базы данных билетов и заявок примут актуальные состояния.
В противном случае ничего не произойдёт.

%
\newpage
%


\end{document} 
